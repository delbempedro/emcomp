"""
  cycle2

Module that 

To run the main() function, call `julia main.jl` on the terminal.

Dependencies:
- Uses the MeshGenerator module to generate the mesh, MeshUpdater to update the mesh,
Gradient module to calculate the gradient of que potencial (Field) and Plots to plot the results.

Since:
- 09/2024

Authors:
- Pedro Calligaris Delbem <pedrodelbem@usp.br>
"""
module cycle2

    # Imports necessary modules
    include("./MeshGenerator.jl")
    include("./MeshUpdater.jl")
    include("./Gradient.jl")
    include("PlotAll.jl")
    using .MeshGenerator 
    using .MeshUpdater
    using .Gradient
    using .PlotAll

    function main()

        # define de mesh length
        side::Int = 300
        minimum_iterations::Int = 100

        # list of the poins with charge
        list_of_points::Vector{Tuple{Int, Int}} = [(48, 43),(49, 43),(50, 43),(51, 43),(52, 43),#I
                        (49, 47),(50, 47),(51, 47),(52, 47),(53, 47),
                        (48, 49),(49, 49),
                        (48, 51),(49, 51),#F
                        (49, 53),(50, 53),(51, 53),(51, 55),(53, 55),
                        (47, 54),(47, 55),
                        (51, 54),(51, 55),
                        (53, 54),(53, 55),#S
                        (47, 59),(48, 59),(49, 59),(50, 59),(51, 59),(52, 59),
                        (47, 60),(47, 61),
                        (53, 60),(53, 61)]

        two_charges::Vector{Tuple{Int, Int}}  = [(3,3), (9,9)]

        four_charges::Vector{Tuple{Int, Int}} = [(25,25), (25,75), (75,25), (75,75)]

        ampere::Vector{Tuple{Int, Int}} = [(284, 64), (281, 63), (279, 62), (276, 62), (274, 62), (275, 62), (277, 62), (280, 62), (282, 61), (283, 60), (285, 61), (286, 63), (284, 64), (255, 56), (254, 55), (254, 53), (255, 54), (257, 56), (259, 56), (261, 55), (262, 53), (262, 50), (262, 48), (260, 49), (258, 50), (255, 50), (253, 49), (252, 47), (251, 44), (251, 42), (251, 39), (253, 38), (255, 37), (258, 38), (260, 39), (261, 41), (262, 44), (263, 46), (264, 48), (264, 51), (264, 53), (263, 55), (261, 57), (258, 57), (256, 57), (255, 56), (261, 46), (261, 43), (259, 41), (258, 39), (255, 38), (253, 39), (253, 41), (253, 44), (253, 46), (255, 48), (257, 49), (259, 49), (272, 56), (273, 54), (272, 51), (272, 49), (271, 47), (270, 44), (269, 42), (268, 40), (268, 38), (270, 38), (273, 38), (275, 38), (278, 38), (280, 38), (282, 39), (283, 41), (284, 44), (283, 43), (281, 41), (280, 39), (277, 39), (275, 39), (272, 39), (272, 41), (272, 44), (273, 46), (273, 49), (274, 51), (275, 53), (276, 55), (278, 55), (281, 55), (283, 55), (285, 53), (285, 51), (285, 53), (285, 56), (284, 56), (281, 56), (279, 56), (276, 56), (274, 56), (278, 49), (277, 47), (279, 45), (280, 47), (280, 50), (279, 50), (152, 47), (151, 44), (150, 42), (149, 40), (148, 37), (147, 35), (147, 33), (147, 30), (147, 28), (146, 25), (147, 23), (147, 20), (147, 18), (148, 15), (148, 13), (149, 10), (150, 8), (152, 6), (153, 4), (155, 2), (156, 1), (155, 3), (154, 5), (152, 8), (151, 10), (150, 12), (150, 15), (149, 17), (149, 20), (149, 22), (149, 25), (149, 27), (149, 30), (149, 32), (149, 35), (149, 37), (150, 40), (151, 42), (152, 44), (153, 46), (155, 48), (156, 50), (154, 49), (152, 47), (290, 50), (291, 47), (293, 45), (294, 43), (295, 41), (296, 38), (296, 36), (297, 34), (297, 31), (297, 29), (297, 26), (297, 24), (297, 21), (297, 19), (296, 16), (296, 14), (295, 11), (294, 9), (293, 7), (291, 5), (290, 2), (291, 2), (293, 4), (294, 6), (295, 9), (296, 11), (297, 13), (298, 16), (299, 18), (299, 20), (299, 23), (299, 25), (299, 28), (299, 31), (298, 33), (298, 35), (298, 38), (297, 40), (296, 43), (295, 45), (293, 47), (292, 49), (290, 50), (75, 45), (72, 44), (70, 43), (67, 43), (65, 43), (68, 43), (70, 43), (73, 42), (74, 41), (76, 42), (77, 45), (75, 45), (177, 45), (175, 44), (172, 43), (170, 43), (167, 43), (169, 43), (172, 43), (174, 43), (176, 41), (177, 41), (179, 43), (178, 45), (63, 37), (63, 34), (63, 32), (62, 29), (62, 27), (61, 25), (60, 22), (59, 20), (59, 19), (62, 19), (64, 19), (67, 19), (69, 19), (71, 20), (73, 22), (74, 24), (74, 27), (73, 28), (73, 30), (75, 32), (76, 34), (75, 36), (73, 37), (71, 38), (68, 38), (69, 37), (71, 36), (74, 36), (74, 33), (73, 31), (71, 30), (68, 29), (66, 29), (69, 28), (71, 28), (73, 26), (72, 23), (71, 21), (68, 20), (66, 20), (64, 20), (63, 22), (63, 24), (64, 27), (64, 29), (65, 32), (65, 34), (66, 37), (64, 38), (168, 37), (170, 36), (170, 34), (170, 32), (169, 30), (168, 27), (168, 25), (167, 22), (166, 20), (163, 20), (162, 21), (162, 23), (160, 22), (162, 20), (164, 19), (166, 19), (168, 21), (169, 23), (170, 25), (171, 28), (171, 30), (172, 33), (173, 35), (174, 37), (173, 38), (170, 38), (168, 38), (5, 28), (6, 26), (7, 23), (8, 21), (9, 19), (11, 18), (12, 21), (13, 23), (14, 25), (15, 27), (16, 30), (18, 32), (19, 34), (20, 36), (19, 38), (17, 38), (14, 38), (12, 38), (9, 38), (7, 38), (4, 38), (2, 38), (0, 37), (1, 35), (2, 33), (4, 30), (5, 28), (5, 28), (14, 27), (12, 24), (11, 22), (10, 23), (8, 25), (7, 28), (6, 30), (5, 32), (4, 34), (6, 35), (8, 35), (11, 35), (13, 36), (16, 36), (18, 36), (17, 33), (16, 31), (15, 29), (199, 31), (199, 28), (198, 26), (196, 26), (193, 26), (191, 26), (192, 26), (194, 26), (197, 25), (198, 24), (199, 21), (199, 19), (200, 18), (200, 21), (201, 23), (202, 25), (204, 26), (206, 26), (209, 26), (207, 26), (204, 26), (202, 26), (201, 28), (201, 30), (200, 33), (199, 34), (199, 32), (34, 29), (36, 27), (38, 26), (36, 24), (34, 22), (32, 20), (34, 20), (35, 22), (37, 24), (39, 24), (41, 23), (43, 21), (45, 20), (44, 21), (42, 23), (40, 25), (40, 27), (42, 29), (44, 30), (45, 32), (43, 31), (41, 29), (40, 27), (38, 27), (36, 29), (35, 31), (33, 32), (33, 31), (117, 23), (116, 21), (115, 18), (115, 16), (115, 13), (116, 14), (117, 16), (118, 19), (120, 19), (122, 19), (124, 20), (126, 19), (128, 20), (129, 22), (128, 21), (126, 20), (126, 23), (127, 25), (127, 27), (127, 30), (126, 30), (125, 27), (125, 25), (124, 22), (122, 20), (120, 20), (119, 21), (119, 24), (119, 26), (120, 29), (120, 31), (119, 30), (118, 28), (117, 25), (227, 30), (226, 27), (226, 25), (225, 23), (225, 21), (227, 19), (229, 19), (232, 19), (233, 21), (232, 21), (230, 20), (227, 20), (226, 22), (227, 24), (230, 24), (231, 26), (229, 27), (227, 27), (228, 29), (230, 30), (233, 30), (235, 30), (234, 31), (231, 31), (229, 31), (133, 28), (132, 26), (131, 24), (131, 21), (131, 19), (132, 16), (133, 15), (136, 14), (138, 14), (139, 17), (139, 19), (140, 22), (139, 24), (139, 26), (137, 28), (135, 29), (133, 28), (138, 24), (139, 22), (138, 19), (138, 17), (136, 15), (134, 15), (133, 17), (133, 20), (133, 22), (133, 25), (134, 27), (135, 28), (137, 27), (239, 28), (238, 26), (238, 23), (238, 21), (238, 18), (238, 16), (240, 14), (242, 14), (244, 15), (245, 17), (246, 20), (246, 22), (245, 25), (245, 27), (243, 29), (241, 29), (239, 28), (244, 25), (244, 22), (244, 20), (244, 18), (243, 15), (241, 15), (239, 16), (239, 18), (239, 21), (239, 23), (239, 26), (240, 28), (243, 28), (91, 28), (93, 28), (96, 28), (98, 28), (101, 28), (100, 28), (97, 28), (95, 28), (92, 28), (90, 28), (258, 26), (260, 26), (263, 26), (265, 26), (268, 26), (270, 26), (273, 26), (275, 26), (278, 26), (279, 26), (276, 26), (274, 26), (271, 26), (269, 26), (266, 26), (264, 26), (261, 26), (259, 26), (256, 26), (257, 26), (87, 23), (89, 23), (92, 23), (94, 23), (97, 23), (99, 23), (102, 23), (104, 23), (103, 24), (100, 24), (98, 24), (95, 24), (93, 24), (90, 24), (88, 24), (261, 18), (260, 16), (261, 15), (261, 17), (263, 18), (266, 18), (268, 17), (268, 14), (268, 12), (267, 10), (267, 7), (266, 5), (265, 3), (263, 1), (261, 1), (259, 1), (258, 4), (258, 6), (259, 9), (261, 10), (263, 11), (266, 12), (264, 12), (262, 12), (259, 11), (258, 9), (257, 7), (257, 4), (257, 2), (259, 0), (262, 0), (264, 0), (266, 2), (268, 4), (269, 6), (270, 8), (270, 11), (270, 13), (270, 16), (268, 18), (266, 19), (264, 20), (261, 19), (276, 17), (276, 14), (274, 13), (272, 12), (274, 11), (274, 9), (273, 6), (273, 4), (273, 1), (274, 0), (277, 1), (279, 2), (279, 4), (277, 2), (276, 1), (275, 2), (275, 5), (275, 7), (276, 10), (278, 12), (279, 12), (277, 14), (277, 16)]
        
        faraday::Vector{Tuple{Int, Int}} = [(295, 71), (293, 70), (291, 69), (288, 69), (285, 69), (282, 69), (285, 69), (287, 69), (290, 69), (293, 68), (294, 66), (296, 67), (297, 69), (296, 72), (295, 71), (137, 65), (136, 63), (133, 63), (130, 63), (127, 63), (125, 63), (122, 63), (119, 63), (121, 62), (124, 62), (127, 62), (130, 61), (133, 61), (135, 61), (135, 59), (136, 58), (139, 60), (141, 61), (140, 64), (138, 66), (137, 67), (258, 61), (256, 58), (258, 57), (258, 60), (260, 61), (263, 62), (265, 61), (267, 59), (267, 56), (267, 53), (266, 52), (264, 54), (261, 54), (259, 53), (256, 52), (254, 50), (253, 47), (252, 45), (252, 42), (253, 39), (256, 38), (259, 38), (261, 38), (264, 40), (266, 42), (267, 44), (268, 46), (269, 49), (270, 52), (270, 55), (269, 57), (268, 60), (266, 62), (264, 63), (261, 63), (259, 62), (258, 61), (265, 46), (264, 43), (263, 41), (260, 39), (258, 39), (255, 40), (255, 42), (255, 45), (256, 48), (257, 50), (259, 52), (262, 53), (264, 52), (265, 49), (279, 61), (280, 59), (280, 56), (279, 53), (279, 51), (278, 48), (277, 45), (276, 43), (275, 40), (273, 39), (272, 38), (275, 38), (278, 38), (280, 38), (283, 38), (286, 38), (289, 39), (291, 40), (293, 42), (294, 44), (294, 47), (292, 49), (292, 51), (294, 53), (296, 55), (296, 58), (295, 60), (292, 61), (290, 61), (287, 61), (284, 61), (281, 61), (279, 61), (279, 61), (293, 55), (291, 53), (288, 51), (286, 51), (283, 51), (282, 53), (282, 55), (283, 58), (285, 60), (287, 60), (290, 60), (293, 59), (293, 57), (291, 43), (289, 41), (287, 40), (284, 39), (281, 39), (279, 39), (279, 42), (280, 45), (280, 48), (281, 50), (284, 49), (287, 49), (290, 49), (291, 47), (9, 35), (10, 32), (11, 30), (12, 27), (14, 25), (15, 22), (16, 20), (18, 17), (20, 18), (21, 20), (23, 23), (24, 25), (25, 28), (26, 30), (28, 33), (29, 35), (30, 38), (31, 40), (33, 43), (34, 45), (35, 48), (36, 50), (37, 53), (34, 53), (32, 53), (29, 53), (26, 53), (23, 53), (20, 53), (18, 53), (15, 53), (12, 53), (9, 53), (6, 53), (4, 53), (1, 53), (0, 51), (1, 49), (3, 46), (4, 44), (5, 41), (6, 39), (8, 36), (8, 35), (32, 46), (31, 44), (30, 41), (29, 39), (28, 36), (26, 34), (25, 31), (24, 29), (23, 26), (21, 24), (20, 22), (18, 24), (17, 27), (16, 29), (15, 32), (13, 34), (12, 37), (11, 39), (10, 42), (8, 44), (7, 47), (7, 49), (10, 49), (13, 49), (16, 49), (19, 49), (21, 49), (24, 49), (27, 49), (30, 49), (33, 49), (113, 52), (115, 51), (117, 50), (116, 47), (116, 45), (115, 42), (114, 39), (114, 36), (113, 34), (112, 31), (112, 28), (111, 26), (110, 23), (109, 20), (107, 19), (105, 19), (108, 18), (110, 18), (113, 18), (116, 18), (119, 18), (122, 18), (125, 18), (127, 18), (130, 18), (133, 19), (134, 22), (135, 24), (136, 27), (137, 29), (136, 30), (135, 27), (133, 25), (131, 23), (129, 21), (127, 20), (124, 20), (121, 20), (118, 20), (115, 20), (114, 21), (114, 24), (115, 27), (116, 29), (116, 32), (118, 34), (120, 35), (123, 35), (126, 34), (126, 32), (127, 30), (128, 32), (129, 35), (129, 38), (130, 40), (129, 42), (128, 40), (127, 37), (124, 37), (121, 37), (118, 37), (118, 39), (119, 42), (119, 44), (120, 47), (121, 50), (123, 51), (126, 51), (129, 50), (132, 50), (134, 50), (137, 49), (138, 47), (138, 44), (138, 42), (139, 44), (140, 47), (140, 50), (139, 52), (137, 52), (134, 52), (131, 52), (128, 52), (125, 52), (123, 52), (120, 52), (117, 52), (114, 52), (59, 42), (60, 40), (62, 38), (64, 35), (66, 33), (68, 31), (68, 29), (66, 27), (64, 25), (62, 23), (60, 21), (59, 19), (61, 20), (63, 22), (65, 24), (67, 26), (69, 28), (71, 28), (73, 26), (75, 24), (77, 22), (79, 20), (82, 19), (81, 21), (79, 23), (77, 25), (76, 27), (74, 29), (73, 31), (75, 33), (77, 35), (78, 37), (80, 39), (82, 41), (81, 41), (78, 40), (76, 38), (74, 36), (72, 34), (70, 32), (68, 34), (66, 36), (64, 38), (62, 40), (60, 42), (159, 36), (161, 35), (164, 35), (167, 35), (170, 35), (172, 35), (175, 35), (178, 35), (181, 35), (184, 35), (186, 35), (189, 35), (188, 36), (186, 36), (183, 36), (180, 36), (177, 36), (174, 36), (172, 36), (169, 36), (166, 36), (163, 36), (160, 36), (212, 31), (214, 30), (217, 30), (220, 30), (223, 30), (225, 30), (228, 30), (231, 30), (234, 30), (237, 30), (239, 30), (242, 30), (240, 31), (237, 31), (235, 31), (232, 31), (229, 31), (226, 31), (223, 31), (221, 31), (218, 31), (215, 31), (212, 31), (251, 31), (253, 30), (256, 30), (259, 30), (262, 30), (264, 30), (267, 30), (270, 30), (273, 30), (276, 30), (278, 30), (281, 30), (284, 30), (287, 30), (290, 30), (292, 30), (295, 30), (298, 30), (298, 31), (296, 31), (293, 31), (290, 31), (287, 31), (284, 31), (282, 31), (279, 31), (276, 31), (273, 31), (270, 31), (267, 31), (265, 31), (262, 31), (259, 31), (256, 31), (253, 31), (251, 31), (159, 27), (161, 26), (164, 26), (167, 26), (170, 26), (172, 26), (175, 26), (178, 26), (181, 26), (184, 26), (186, 26), (189, 26), (188, 27), (186, 27), (183, 27), (180, 27), (177, 27), (174, 27), (172, 27), (169, 27), (166, 27), (163, 27), (160, 27), (265, 23), (264, 21), (265, 20), (267, 22), (268, 24), (271, 24), (274, 23), (275, 20), (275, 18), (275, 15), (273, 15), (271, 16), (268, 16), (266, 15), (264, 14), (262, 11), (260, 9), (260, 6), (260, 4), (262, 1), (264, 0), (267, 0), (270, 0), (272, 2), (274, 4), (275, 7), (276, 9), (277, 12), (277, 15), (277, 18), (277, 20), (276, 23), (274, 25), (271, 25), (268, 25), (266, 24), (265, 23), (273, 11), (273, 9), (272, 6), (271, 3), (269, 2), (266, 1), (264, 2), (263, 4), (263, 7), (263, 10), (265, 12), (266, 14), (269, 16), (271, 15), (285, 22), (284, 19), (283, 17), (281, 15), (280, 14), (282, 13), (282, 11), (281, 8), (281, 5), (281, 2), (282, 0), (285, 0), (287, 2), (288, 4), (286, 2), (284, 1), (283, 2), (283, 5), (284, 8), (284, 11), (285, 13), (288, 14), (289, 15), (286, 16), (286, 18), (287, 21), (285, 22)]

        gaussB::Vector{Tuple{Int, Int}} = [(151, 68), (151, 66), (150, 64), (147, 64), (144, 64), (141, 64), (138, 64), (134, 64), (131, 64), (129, 63), (129, 62), (132, 62), (135, 62), (138, 62), (141, 62), (144, 62), (147, 61), (150, 61), (148, 59), (149, 57), (151, 58), (154, 60), (156, 62), (156, 64), (154, 66), (152, 69), (6, 35), (8, 33), (9, 30), (10, 27), (12, 24), (13, 22), (14, 19), (16, 16), (17, 14), (18, 11), (20, 8), (21, 6), (23, 3), (25, 1), (27, 2), (28, 5), (30, 8), (31, 10), (33, 13), (34, 16), (35, 18), (37, 21), (38, 24), (39, 26), (41, 29), (42, 32), (43, 35), (45, 37), (46, 40), (47, 43), (49, 45), (50, 48), (49, 49), (46, 49), (43, 49), (40, 49), (37, 49), (33, 49), (30, 49), (27, 49), (24, 50), (21, 50), (18, 50), (15, 50), (12, 50), (9, 50), (6, 50), (3, 50), (0, 50), (1, 47), (2, 45), (3, 42), (5, 39), (6, 37), (6, 35), (44, 41), (43, 39), (42, 36), (40, 33), (39, 30), (38, 28), (36, 25), (35, 22), (34, 20), (32, 17), (31, 14), (30, 12), (28, 9), (27, 7), (25, 10), (24, 12), (23, 15), (21, 18), (20, 20), (19, 23), (17, 26), (16, 28), (15, 31), (13, 34), (12, 37), (11, 39), (9, 42), (10, 44), (13, 44), (16, 44), (19, 44), (22, 44), (25, 44), (28, 44), (31, 44), (34, 44), (37, 44), (40, 44), (43, 44), (118, 49), (120, 48), (123, 47), (123, 44), (123, 41), (122, 39), (121, 36), (121, 33), (120, 30), (119, 27), (118, 24), (118, 21), (117, 18), (116, 15), (115, 12), (114, 9), (113, 6), (111, 5), (108, 4), (107, 3), (110, 3), (113, 3), (116, 3), (119, 3), (122, 3), (125, 3), (128, 3), (131, 3), (134, 3), (137, 3), (140, 5), (143, 6), (145, 8), (148, 10), (149, 12), (150, 15), (150, 18), (150, 21), (148, 23), (145, 25), (143, 27), (144, 28), (147, 29), (149, 31), (152, 33), (153, 36), (154, 39), (154, 42), (153, 44), (151, 47), (149, 49), (146, 49), (143, 49), (140, 49), (137, 49), (134, 49), (131, 49), (128, 49), (125, 49), (122, 49), (119, 49), (118, 49), (148, 43), (149, 40), (148, 37), (147, 35), (145, 32), (143, 30), (140, 29), (137, 28), (134, 28), (131, 28), (128, 27), (125, 28), (125, 30), (126, 33), (126, 36), (127, 39), (128, 42), (129, 45), (130, 47), (133, 48), (136, 48), (139, 47), (142, 47), (145, 46), (147, 46), (144, 21), (145, 18), (144, 15), (143, 12), (142, 10), (139, 8), (137, 6), (134, 5), (131, 5), (128, 5), (125, 5), (122, 5), (119, 5), (119, 8), (120, 11), (121, 14), (122, 17), (122, 20), (123, 23), (124, 26), (127, 26), (130, 26), (133, 26), (136, 26), (139, 25), (142, 24), (255, 44), (253, 42), (252, 39), (251, 37), (250, 34), (250, 31), (250, 28), (250, 25), (250, 22), (250, 19), (250, 16), (250, 13), (251, 10), (253, 7), (255, 5), (257, 3), (260, 2), (263, 1), (266, 2), (268, 3), (271, 6), (272, 8), (273, 11), (274, 14), (274, 17), (275, 20), (275, 23), (275, 26), (275, 29), (274, 32), (274, 35), (273, 38), (272, 41), (271, 43), (269, 45), (266, 47), (263, 47), (260, 47), (257, 46), (255, 44), (255, 44), (268, 43), (269, 41), (270, 38), (271, 35), (271, 32), (271, 29), (271, 26), (271, 23), (271, 20), (271, 17), (270, 14), (270, 11), (269, 8), (268, 5), (265, 4), (262, 3), (259, 4), (257, 6), (255, 8), (254, 11), (254, 14), (254, 17), (254, 20), (254, 23), (254, 26), (254, 29), (254, 32), (254, 35), (254, 38), (255, 41), (257, 43), (259, 45), (262, 46), (265, 45), (182, 27), (182, 25), (185, 25), (188, 25), (191, 25), (194, 25), (197, 25), (200, 25), (203, 25), (206, 25), (209, 25), (212, 25), (215, 25), (218, 25), (221, 25), (223, 26), (220, 26), (217, 26), (214, 26), (211, 27), (208, 27), (205, 27), (202, 27), (199, 27), (196, 27), (193, 27), (190, 27), (187, 27), (184, 27), (77, 22), (76, 19), (78, 17), (80, 17), (82, 19), (82, 22), (79, 23), (77, 22), (181, 15), (182, 13), (185, 13), (188, 13), (191, 13), (194, 13), (197, 13), (201, 13), (204, 13), (207, 13), (210, 13), (213, 13), (216, 13), (219, 13), (222, 13), (222, 14), (219, 14), (216, 15), (213, 15), (210, 15), (207, 15), (204, 15), (201, 15), (198, 15), (195, 15), (192, 15), (189, 15), (186, 15), (183, 15)]

        gauss::Vector{Tuple{Int, Int}} = [(272, 133), (269, 130), (267, 128), (265, 124), (264, 121), (262, 118), (261, 114), (261, 111), (260, 107), (259, 104), (258, 100), (257, 97), (257, 93), (257, 90), (260, 92), (261, 95), (262, 99), (263, 102), (263, 106), (265, 107), (268, 104), (271, 104), (275, 105), (278, 107), (280, 109), (283, 112), (284, 115), (286, 118), (286, 122), (286, 125), (285, 129), (283, 132), (280, 134), (277, 134), (273, 133), (272, 133), (282, 128), (282, 125), (282, 121), (281, 118), (280, 114), (278, 111), (276, 108), (273, 106), (270, 105), (267, 107), (265, 110), (265, 114), (266, 117), (267, 121), (269, 124), (270, 127), (272, 130), (275, 133), (279, 133), (147, 121), (146, 119), (143, 119), (139, 119), (136, 119), (132, 118), (128, 118), (125, 118), (125, 117), (129, 117), (133, 117), (136, 116), (140, 116), (143, 116), (146, 115), (144, 113), (146, 112), (149, 114), (152, 117), (150, 120), (148, 123), (147, 121), (11, 81), (13, 77), (14, 74), (16, 71), (18, 68), (19, 64), (21, 61), (23, 58), (25, 58), (27, 61), (29, 64), (31, 67), (32, 70), (34, 74), (36, 77), (37, 80), (39, 83), (41, 86), (42, 90), (44, 93), (45, 96), (47, 99), (48, 103), (46, 104), (42, 104), (39, 104), (35, 104), (31, 104), (28, 104), (24, 105), (20, 105), (17, 105), (13, 105), (10, 105), (6, 105), (2, 105), (0, 104), (2, 101), (3, 97), (5, 94), (6, 91), (8, 88), (9, 84), (11, 81), (11, 81), (34, 78), (32, 75), (31, 72), (29, 68), (27, 65), (26, 64), (24, 67), (22, 70), (21, 73), (19, 77), (17, 80), (16, 83), (14, 86), (12, 90), (11, 93), (9, 96), (8, 99), (11, 100), (14, 100), (18, 100), (22, 100), (25, 100), (29, 100), (32, 100), (36, 100), (40, 100), (43, 100), (43, 97), (42, 94), (40, 91), (39, 88), (37, 85), (115, 104), (118, 102), (120, 100), (119, 97), (118, 93), (118, 90), (117, 86), (116, 83), (115, 79), (114, 76), (113, 72), (112, 69), (111, 65), (110, 62), (107, 61), (104, 59), (107, 59), (111, 59), (114, 59), (118, 59), (122, 59), (125, 59), (129, 59), (133, 59), (136, 59), (140, 59), (141, 61), (143, 65), (144, 68), (146, 71), (147, 75), (145, 74), (143, 71), (142, 67), (139, 65), (136, 63), (133, 61), (129, 61), (126, 61), (122, 61), (119, 61), (116, 62), (116, 65), (117, 69), (118, 72), (119, 76), (120, 79), (123, 81), (126, 81), (130, 81), (132, 79), (132, 75), (134, 75), (135, 79), (136, 82), (137, 86), (137, 89), (136, 90), (135, 87), (132, 84), (129, 83), (125, 83), (122, 83), (122, 87), (123, 90), (124, 94), (125, 97), (126, 101), (129, 102), (132, 102), (136, 102), (139, 102), (143, 101), (146, 100), (147, 97), (148, 93), (148, 90), (149, 92), (150, 95), (150, 99), (151, 102), (149, 105), (146, 105), (142, 105), (138, 105), (135, 105), (131, 104), (127, 104), (124, 104), (120, 104), (117, 104), (175, 82), (178, 81), (182, 81), (185, 81), (189, 81), (192, 81), (196, 81), (200, 81), (203, 81), (207, 81), (210, 81), (214, 81), (216, 82), (212, 82), (208, 82), (205, 82), (201, 82), (198, 82), (194, 82), (190, 82), (187, 82), (183, 82), (179, 82), (176, 82), (75, 78), (74, 75), (76, 73), (79, 74), (80, 77), (77, 79), (242, 76), (245, 75), (248, 75), (252, 75), (256, 75), (259, 75), (263, 75), (266, 75), (270, 75), (274, 75), (277, 75), (281, 75), (284, 75), (288, 75), (292, 75), (295, 75), (299, 75), (297, 77), (294, 77), (290, 77), (287, 77), (283, 77), (279, 77), (276, 77), (272, 77), (268, 77), (265, 77), (261, 77), (258, 77), (254, 77), (250, 77), (247, 77), (243, 77), (175, 70), (178, 69), (182, 69), (185, 69), (189, 69), (192, 69), (196, 69), (200, 69), (203, 69), (207, 69), (210, 69), (214, 69), (216, 70), (212, 70), (208, 70), (205, 70), (201, 70), (198, 70), (194, 70), (190, 70), (187, 70), (183, 70), (179, 70), (176, 70), (255, 42), (252, 41), (249, 39), (247, 36), (247, 32), (248, 29), (246, 26), (244, 23), (243, 20), (245, 16), (247, 14), (251, 13), (254, 13), (258, 13), (261, 14), (264, 16), (265, 19), (262, 17), (258, 15), (255, 15), (251, 15), (248, 17), (245, 19), (245, 22), (247, 25), (250, 28), (253, 28), (257, 28), (261, 28), (260, 31), (256, 31), (253, 31), (249, 32), (248, 34), (250, 37), (253, 39), (257, 40), (260, 40), (264, 40), (267, 38), (269, 40), (267, 42), (263, 43), (259, 43), (256, 42), (279, 35), (277, 32), (276, 29), (275, 25), (275, 22), (275, 18), (275, 15), (275, 11), (276, 7), (277, 4), (280, 1), (283, 0), (287, 0), (290, 1), (292, 3), (294, 7), (295, 10), (295, 14), (295, 17), (295, 21), (295, 25), (294, 28), (293, 32), (291, 35), (288, 37), (285, 37), (281, 37), (279, 35), (291, 31), (292, 28), (292, 24), (292, 20), (292, 17), (292, 13), (292, 10), (291, 6), (289, 3), (286, 1), (283, 1), (280, 4), (279, 7), (278, 10), (278, 14), (278, 18), (278, 21), (278, 25), (279, 28), (280, 32), (282, 35), (285, 36), (288, 35)]

        ifsc::Vector{Tuple{Int,Int}} = [(41, 291), (40, 285), (40, 280), (40, 274), (40, 269), (40, 263), (40, 258), (40, 252), (40, 247), (40, 241), (40, 236), (40, 230), (40, 225), (40, 219), (40, 213), (40, 208), (40, 202), (40, 197), (40, 191), (40, 186), (40, 180), (40, 175), (40, 169), (40, 164), (40, 158), (41, 153), (44, 150), (44, 156), (44, 161), (44, 167), (44, 172), (44, 178), (44, 183), (44, 189), (44, 194), (44, 200), (44, 205), (44, 211), (44, 216), (43, 222), (43, 227), (43, 233), (43, 238), (43, 244), (43, 249), (43, 255), (43, 261), (43, 266), (43, 272), (43, 277), (43, 283), (43, 288), (43, 293), (50, 261), (50, 256), (50, 250), (50, 245), (50, 239), (50, 234), (51, 229), (56, 230), (61, 231), (67, 232), (72, 234), (78, 235), (83, 236), (88, 237), (94, 239), (99, 240), (104, 241), (110, 242), (115, 244), (120, 245), (116, 248), (112, 251), (107, 254), (103, 257), (98, 261), (94, 264), (89, 267), (84, 270), (80, 273), (75, 276), (71, 279), (66, 282), (62, 285), (57, 289), (53, 292), (50, 292), (50, 286), (50, 281), (50, 275), (50, 270), (50, 264), (127, 221), (127, 216), (127, 210), (127, 205), (127, 199), (127, 194), (127, 188), (127, 183), (127, 177), (127, 172), (127, 166), (127, 161), (127, 155), (127, 150), (129, 153), (130, 159), (130, 164), (130, 170), (130, 175), (130, 181), (130, 186), (130, 192), (130, 197), (130, 203), (130, 208), (130, 214), (130, 219), (130, 225), (130, 230), (130, 236), (130, 242), (130, 247), (130, 253), (130, 258), (130, 264), (130, 269), (130, 275), (130, 280), (130, 286), (129, 291), (127, 291), (127, 286), (127, 280), (127, 275), (127, 269), (127, 263), (127, 258), (127, 252), (127, 247), (127, 241), (127, 236), (127, 230), (127, 225), (32, 276), (31, 270), (31, 265), (31, 259), (31, 254), (31, 248), (31, 243), (31, 237), (31, 232), (31, 226), (31, 220), (31, 215), (31, 209), (31, 204), (31, 198), (31, 193), (31, 187), (31, 182), (31, 176), (31, 171), (33, 166), (35, 167), (35, 173), (35, 178), (35, 184), (35, 189), (35, 195), (35, 201), (35, 206), (35, 212), (35, 217), (34, 223), (34, 228), (34, 234), (34, 239), (34, 245), (34, 250), (34, 256), (34, 261), (34, 267), (34, 272), (34, 278), (136, 221), (136, 216), (136, 210), (136, 205), (136, 199), (136, 194), (136, 188), (136, 183), (136, 177), (136, 172), (136, 166), (137, 167), (139, 172), (139, 177), (139, 183), (139, 188), (139, 194), (139, 200), (139, 205), (139, 211), (139, 216), (139, 222), (139, 227), (139, 233), (139, 238), (139, 244), (139, 249), (139, 255), (139, 260), (139, 266), (139, 271), (137, 277), (136, 275), (136, 270), (136, 264), (136, 259), (136, 253), (136, 248), (136, 242), (136, 237), (136, 231), (136, 226), (23, 261), (22, 255), (22, 250), (22, 244), (22, 239), (22, 233), (22, 228), (22, 222), (22, 217), (22, 211), (22, 206), (22, 200), (22, 195), (22, 189), (23, 184), (25, 184), (25, 190), (25, 195), (25, 201), (25, 206), (25, 212), (25, 217), (25, 223), (25, 228), (25, 234), (25, 239), (25, 245), (25, 250), (25, 256), (25, 261), (23, 261), (145, 222), (145, 217), (145, 211), (145, 205), (145, 200), (145, 194), (145, 189), (145, 183), (148, 184), (148, 190), (148, 195), (148, 201), (148, 206), (148, 212), (148, 217), (148, 223), (148, 228), (148, 234), (148, 239), (148, 245), (148, 250), (148, 256), (146, 261), (145, 262), (145, 256), (145, 251), (145, 245), (145, 240), (145, 234), (145, 229), (145, 223), (14, 246), (13, 241), (13, 235), (13, 230), (13, 224), (13, 219), (13, 213), (13, 208), (13, 202), (15, 197), (17, 196), (17, 201), (17, 207), (17, 212), (17, 218), (16, 223), (16, 229), (16, 235), (16, 240), (16, 246), (15, 248), (154, 222), (154, 217), (154, 211), (154, 206), (154, 200), (154, 195), (156, 198), (157, 204), (157, 209), (157, 215), (157, 220), (157, 226), (157, 231), (157, 237), (157, 242), (155, 247), (154, 248), (154, 242), (154, 237), (154, 231), (154, 226), (3, 228), (1, 223), (2, 219), (4, 214), (7, 212), (7, 218), (7, 223), (7, 229), (7, 234), (5, 230), (163, 222), (163, 216), (163, 211), (166, 215), (169, 220), (169, 225), (166, 229), (163, 232), (163, 227), (95, 208), (89, 207), (84, 205), (78, 204), (73, 203), (68, 201), (62, 200), (57, 199), (52, 198), (52, 195), (57, 192), (61, 189), (66, 186), (71, 183), (75, 180), (80, 177), (84, 173), (89, 170), (93, 167), (98, 164), (102, 161), (107, 158), (112, 155), (116, 152), (120, 151), (120, 156), (120, 161), (120, 167), (120, 173), (120, 178), (120, 184), (120, 189), (120, 195), (120, 200), (120, 206), (120, 211), (116, 213), (111, 212), (105, 211), (100, 209), (95, 208), (8, 104), (8, 99), (8, 93), (8, 87), (8, 82), (8, 76), (11, 75), (17, 75), (22, 75), (28, 75), (33, 75), (39, 75), (44, 75), (50, 75), (55, 75), (55, 81), (55, 86), (55, 92), (60, 92), (66, 92), (71, 92), (74, 95), (69, 95), (63, 95), (58, 95), (52, 95), (51, 91), (51, 85), (50, 79), (47, 78), (41, 78), (36, 78), (33, 80), (33, 85), (33, 91), (33, 96), (33, 102), (33, 107), (33, 113), (33, 118), (33, 124), (33, 129), (37, 131), (42, 131), (48, 131), (53, 131), (59, 131), (65, 131), (70, 131), (74, 133), (69, 133), (63, 133), (58, 133), (52, 133), (47, 133), (41, 133), (36, 134), (30, 134), (24, 134), (19, 134), (13, 134), (8, 134), (8, 128), (8, 123), (8, 117), (8, 112), (8, 106), (8, 104), (29, 98), (29, 93), (29, 87), (29, 82), (27, 78), (22, 78), (16, 78), (11, 78), (11, 84), (11, 89), (11, 95), (11, 100), (11, 106), (11, 111), (11, 117), (11, 122), (11, 128), (15, 130), (20, 130), (26, 130), (29, 128), (29, 122), (29, 116), (29, 111), (29, 105), (78, 132), (74, 128), (73, 123), (73, 117), (68, 117), (62, 116), (57, 116), (53, 114), (58, 114), (64, 114), (70, 114), (74, 111), (78, 107), (82, 103), (86, 99), (90, 95), (94, 95), (90, 99), (87, 103), (83, 108), (79, 112), (77, 116), (77, 122), (78, 127), (83, 129), (88, 129), (94, 129), (99, 129), (105, 129), (110, 129), (115, 127), (120, 126), (124, 129), (129, 129), (135, 129), (140, 129), (146, 130), (151, 130), (157, 130), (161, 127), (161, 122), (161, 116), (156, 116), (150, 116), (145, 116), (139, 116), (139, 110), (139, 105), (139, 99), (139, 94), (143, 93), (149, 93), (154, 93), (160, 93), (160, 88), (160, 82), (159, 78), (153, 78), (148, 78), (142, 78), (136, 78), (131, 78), (125, 78), (121, 78), (120, 84), (120, 89), (120, 95), (116, 99), (113, 103), (109, 107), (105, 111), (100, 114), (103, 109), (106, 105), (110, 101), (114, 97), (117, 92), (116, 87), (115, 81), (111, 78), (105, 78), (100, 78), (94, 78), (89, 78), (83, 78), (78, 79), (74, 83), (74, 79), (78, 74), (83, 74), (89, 74), (94, 74), (100, 74), (106, 74), (111, 74), (116, 76), (122, 75), (127, 75), (133, 75), (138, 75), (144, 75), (150, 75), (155, 75), (161, 75), (164, 77), (164, 83), (164, 88), (164, 94), (160, 97), (155, 97), (149, 97), (144, 97), (142, 100), (142, 105), (142, 111), (148, 111), (153, 111), (159, 111), (164, 112), (164, 118), (164, 123), (164, 129), (162, 134), (157, 134), (151, 134), (146, 134), (140, 134), (135, 133), (129, 133), (124, 133), (118, 133), (113, 133), (108, 133), (102, 134), (97, 134), (91, 133), (86, 133), (80, 132), (8, 34), (8, 29), (8, 23), (8, 18), (8, 12), (9, 7), (13, 3), (18, 1), (23, 0), (29, 0), (34, 0), (40, 0), (45, 0), (51, 0), (56, 3), (60, 6), (64, 3), (69, 1), (74, 0), (80, 0), (85, 0), (91, 0), (96, 0), (102, 1), (107, 3), (111, 7), (112, 12), (113, 18), (112, 23), (108, 27), (104, 31), (100, 34), (96, 38), (92, 42), (87, 45), (86, 43), (90, 39), (94, 36), (98, 32), (102, 28), (106, 24), (110, 20), (109, 15), (108, 10), (105, 5), (100, 4), (94, 4), (89, 4), (83, 4), (78, 4), (72, 4), (67, 5), (64, 9), (61, 14), (57, 11), (54, 6), (49, 4), (43, 4), (38, 4), (32, 4), (27, 4), (21, 4), (16, 5), (12, 9), (12, 15), (12, 20), (12, 26), (12, 31), (12, 37), (12, 42), (12, 48), (12, 53), (15, 56), (20, 56), (26, 56), (31, 56), (33, 51), (33, 46), (33, 40), (33, 35), (33, 29), (33, 23), (33, 18), (35, 14), (36, 19), (36, 25), (36, 30), (36, 36), (36, 41), (36, 47), (36, 52), (39, 56), (44, 56), (50, 56), (55, 56), (56, 59), (50, 59), (45, 59), (39, 59), (34, 59), (28, 60), (23, 60), (17, 60), (12, 60), (8, 58), (8, 53), (8, 47), (8, 42), (8, 36), (67, 57), (62, 54), (59, 49), (59, 44), (59, 38), (61, 34), (65, 30), (69, 27), (73, 23), (78, 19), (82, 15), (86, 14), (83, 18), (79, 22), (75, 26), (71, 30), (67, 34), (63, 38), (62, 43), (63, 48), (66, 53), (71, 56), (76, 56), (82, 56), (87, 56), (93, 56), (98, 56), (103, 55), (107, 51), (110, 46), (114, 49), (117, 53), (122, 56), (127, 56), (133, 56), (138, 56), (144, 56), (149, 56), (155, 54), (159, 51), (160, 45), (160, 40), (161, 34), (161, 29), (160, 24), (155, 24), (149, 24), (144, 24), (139, 24), (139, 29), (138, 35), (138, 41), (137, 45), (135, 41), (135, 36), (135, 30), (135, 25), (135, 19), (135, 14), (135, 8), (134, 4), (128, 4), (123, 3), (117, 3), (114, 1), (120, 1), (125, 0), (131, 0), (136, 0), (139, 4), (139, 9), (139, 15), (139, 20), (145, 20), (150, 20), (156, 20), (161, 20), (164, 23), (164, 28), (164, 34), (163, 39), (163, 45), (162, 50), (160, 55), (155, 58), (149, 59), (144, 59), (138, 60), (133, 60), (127, 59), (122, 59), (117, 57), (113, 53), (108, 55), (104, 58), (98, 59), (93, 59), (87, 59), (82, 59), (76, 59), (71, 59)]
        
        usp::Vector{Tuple{Int,Int}} = [(27, 52), (26, 52), (25, 53), (24, 54), (23, 54), (22, 54), (21, 54), (20, 54), (19, 54), (18, 54), (17, 54), (16, 54), (15, 54), (14, 54), (13, 54), (12, 54), (12, 53), (11, 52), (10, 52), (10, 51), (10, 50), (10, 49), (10, 48), (10, 47), (10, 46), (10, 45), (10, 44), (10, 43), (10, 42), (10, 41), (10, 40), (10, 39), (10, 38), (10, 37), (10, 36), (10, 35), (10, 34), (10, 33), (11, 33), (12, 33), (13, 33), (15, 33), (16, 33), (17, 33), (18, 33), (19, 33), (20, 33), (21, 33), (22, 33), (23, 33), (24, 33), (25, 33), (26, 33), (26, 34), (26, 35), (25, 35), (24, 35), (23, 35), (22, 35), (21, 35), (20, 35), (19, 35), (19, 36), (19, 37), (19, 38), (19, 39), (19, 40), (19, 41), (19, 42), (19, 43), (19, 44), (19, 45), (19, 46), (19, 47), (19, 49), (19, 49), (18, 49), (18, 48), (18, 47), (18, 46), (18, 45), (18, 44), (18, 43), (18, 42), (18, 41), (18, 40), (18, 39), (18, 38), (18, 37), (18, 36), (18, 35), (17, 35), (16, 35), (15, 35), (14, 35), (13, 35), (12, 35), (11, 35), (11, 36), (11, 37), (11, 38), (11, 39), (11, 40), (11, 41), (11, 42), (11, 43), (11, 44), (11, 45), (11, 46), (11, 47), (11, 48), (11, 49), (11, 50), (11, 51), (12, 52), (13, 52), (14, 53), (15, 53), (16, 53), (17, 53), (18, 53), (19, 53), (20, 53), (21, 53), (22, 53), (23, 53), (24, 52), (25, 52), (25, 51), (26, 50), (26, 49), (27, 49), (27, 50), (28, 51), (28, 52), (29, 52), (30, 52), (31, 53), (32, 53), (33, 53), (34, 53), (35, 53), (36, 53), (37, 53), (38, 53), (39, 53), (40, 52), (41, 51), (41, 51), (42, 50), (42, 49), (42, 48), (42, 47), (41, 46), (40, 45), (40, 45), (39, 44), (38, 43), (37, 42), (37, 42), (36, 41), (35, 40), (35, 40), (34, 39), (34, 38), (35, 38), (36, 39), (36, 39), (37, 40), (38, 41), (39, 42), (39, 42), (40, 43), (41, 44), (41, 44), (42, 45), (43, 46), (43, 47), (43, 48), (43, 49), (43, 50), (43, 51), (42, 52), (42, 52), (41, 53), (40, 54), (39, 54), (38, 54), (37, 54), (36, 54), (35, 54), (34, 54), (33, 54), (32, 54), (31, 54), (30, 54), (29, 54), (28, 53), (27, 53), (27, 52), (42, 36), (43, 35), (44, 34), (45, 34), (46, 34), (47, 33), (48, 33), (49, 33), (50, 33), (51, 33), (52, 33), (53, 33), (54, 33), (55, 33), (56, 34), (57, 34), (58, 34), (58, 35), (59, 36), (59, 37), (59, 38), (59, 39), (59, 40), (59, 41), (59, 42), (59, 43), (59, 44), (59, 45), (59, 46), (59, 47), (59, 47), (58, 47), (57, 47), (56, 47), (55, 47), (53, 47), (52, 47), (51, 47), (51, 48), (51, 49), (51, 50), (51, 51), (51, 52), (51, 53), (51, 54), (50, 54), (49, 54), (48, 54), (47, 54), (46, 54), (45, 54), (44, 54), (43, 54), (43, 53), (44, 53), (45, 53), (46, 53), (47, 53), (48, 53), (49, 53), (50, 53), (50, 52), (50, 51), (50, 50), (50, 49), (50, 48), (50, 47), (50, 46), (50, 45), (50, 44), (50, 43), (50, 42), (50, 41), (50, 40), (50, 39), (51, 38), (51, 39), (51, 40), (51, 41), (51, 42), (51, 43), (51, 44), (51, 45), (51, 46), (52, 46), (53, 46), (54, 46), (55, 46), (56, 46), (57, 46), (58, 46), (58, 45), (58, 44), (58, 43), (58, 42), (58, 41), (58, 40), (58, 39), (58, 38), (58, 37), (57, 36), (56, 35), (55, 35), (54, 35), (53, 35), (52, 35), (51, 35), (50, 35), (49, 35), (48, 35), (47, 35), (46, 35), (45, 35), (44, 36), (44, 36), (43, 37), (43, 38), (42, 38), (42, 38), (41, 37), (41, 36), (40, 35), (39, 35), (38, 35), (37, 35), (36, 35), (35, 35), (34, 35), (33, 35), (32, 35), (31, 35), (30, 35), (29, 35), (28, 36), (27, 36), (27, 37), (27, 38), (27, 39), (27, 40), (27, 41), (28, 42), (28, 42), (29, 43), (30, 44), (31, 45), (31, 45), (32, 46), (33, 47), (33, 48), (34, 48), (34, 49), (34, 50), (33, 49), (32, 48), (32, 47), (31, 47), (30, 46), (29, 45), (29, 45), (28, 44), (27, 43), (27, 42), (26, 42), (25, 41), (25, 40), (25, 39), (25, 38), (25, 37), (26, 36), (26, 35), (27, 34), (28, 34), (29, 34), (30, 33), (31, 33), (32, 33), (33, 33), (34, 33), (35, 33), (36, 33), (37, 33), (38, 33), (39, 34), (40, 34), (41, 34), (42, 35), (42, 36)]
        
        current_list::Vector{Tuple{Int, Int}} = gaussB
        
        # create the mesh
        mesh::Matrix{Float64} = MeshGenerator.InitializeMesh(side, current_list)
        
        # atualize the mesh
        final_mesh::Matrix{Float64} = MeshUpdater.UpdateMesh(mesh, side, minimum_iterations, current_list)

        # compute the gradient of the potential
        Ex::Matrix{Float64}, Ey::Matrix{Float64} = Gradient.compute_gradient(final_mesh, side)

        # create the plot
        PlotAll.CreatePlot(final_mesh, side, current_list, Ex, Ey)


    end

end